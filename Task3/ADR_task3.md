### <a name="_b7urdng99y53"></a>**Название задачи:** Открытие депозитов онлайн — MVP (ADR)
### <a name="_hjk0fkfyohdk"></a>**Автор:** Команда архитектуры (совместно с ЦТ)
### <a name="_uanumrh8zrui"></a>**Дата:** 2025‑09‑06

### <a name="_3bfxc9a45514"></a>**Функциональные требования (Use Cases)**

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
| 1 | Клиент, Сайт, Система КЦ | Подача заявки на сайте | Клиент видит список депозитов со ставками → оставляет ФИО и телефон → заявка уходит в систему КЦ → менеджер перезванивает и при необходимости инициирует согласование спецставки. |
| 2 | Клиент, Интернет‑банк, СМС‑шлюз | Подача заявки в ИБ | Клиент видит список и персональные ставки → указывает счёт и сумму → подтверждает СМС‑кодом → заявка регистрируется в АБС через интеграционный слой. |
| 3 | Бэк‑офис депозитов, АБС | Обработка заявки | Менеджер бэк‑офиса подтверждает условия в АБС; при спецставке — согласование с бэк‑офисом кредитов. |
| 4 | АБС, СМС‑шлюз, Клиент | Оповещения | Клиент получает СМС об утверждённой ставке и об открытии депозита. |
| 5 | Бэк‑офис депозитов/кредитов, АБС | Управление ставками | Ведение базовых и специальных ставок в АБС; аудит изменений и права доступа. |

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования (ключевое из FURPS+)**

|**№**|**Требование**|
| :-: | :- |
| N1 | Доступность 99,9% 24/7 для ИБ и интеграций; переключение на резервный ЦОД. |
| N2 | Декуплинг ИБ от АБС: без прямого доступа; асинхронные интеграции/ретраи, гарантированная доставка. |
| N3 | Производительность: справочники < 1 c, отклик UI — десятки мс, заявка < 300 мс. |
| N4 | Безопасность: TLS 1.2+, СМС‑OTP, защита ПДн; разделение доступа депозитов/кредитов. |
| N5 | Используем существующие стеки: ASP.NET MVC/MS SQL; Java/Spring Boot/Oracle; документация и наблюдаемость. |
| N6 | Масштабирование: ИБ/сайт — горизонтально; АБС — учитывать только вертикальное. |

### <a name="_qmphm5d6rvi3"></a>**Решение**

Диаграммы (см. файлы в `Task3/`):
- `C4_Context.mmd` — контекст (акторы и системы, основные потоки для MVP).
- `C4_Containers.mmd` — контейнеры: детализированы Интернет‑банк и АБС, показан интеграционный слой.

Ключевые решения:
- Интеграционный слой (Java/Spring Boot, совместим с текущими стэками) между ИБ и АБС. Исключаем прямой доступ ИБ к БД/процедурам АБС. Для надёжности — ретраи и outbox/очередь совместимая с текущими системами; миграция на Kafka позже.
- Ставки переносятся из XLS в АБС (PL/SQL), предоставляется чтение для сайта/ИБ через интеграционный слой; кэширование на стороне ИБ/сайта.
- СМС‑OTP используется из ядра ИБ; уведомления инициирует АБС через СМС‑шлюз.
- KYC для новых клиентов остаётся офлайн в отделении.

### <a name="_bjrr7veeh80c"></a>**Альтернативы**
- Прямые вызовы ИБ → АБС (быстро, но нарушает требования надёжности и нагрузочные ограничения).
- Единая шина сообщений (Kafka) сразу: перспективно, но несовместимо с текущей платформой ИБ — переносим на последующие итерации.
- Хранение ставок вне АБС (отдельный сервис): быстрее внедрить, но нарушает консистентность с кредитным блоком и процессом согласования.

**Недостатки, ограничения, риски**
- Узкое место АБС (вертикальное масштабирование); нужны кэширование и асинхрон.
- Риски ПДн при передаче заявок с сайта — строго TLS, минимизация полей, аудит.
- Зависимость от подрядчика КЦ/СМС; ограничение скорости изменений.
- Не все цели по доступности могут быть достигнуты без доработки инфраструктуры ИБ (кластеризация, DR‑практики).

